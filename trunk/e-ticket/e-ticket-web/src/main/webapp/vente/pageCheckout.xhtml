<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="/resources/tpl/pageCorpsTemplate.xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:etsmtl="http://java.sun.com/jsf/composite/etsmtl"
                xmlns:f="http://java.sun.com/jsf/core">


    <ui:define name="content">
        <br/><br/>
        <h:form id="processusPaiment" >
            <p:wizard id="flow" widgetVar="wiz" flowListener="#{processPaiementCtrl.onFlowProcess}" >

                <p:tab id="tickets" title="Tickets">
                    <p:panel header="Checkout Your Tickets">

                        <p:panel header="Affiche tableau avec les toto du panier"  rendered="true" toggleable="true" >       
                            <div style="overflow: auto">
                                <p:dataTable id="dataPaiment" var="pan" value="#{processPaiementCtrl.panierCtrl.paniers}" 
                                             widgetVar="LaTable" paginator="true" rows="10"
                                             emptyMessage="Veuille sélectionner des représentations" rowKey="#{pan}"
                                             editable="true" selectionMode="single"
                                             paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
                                             rowsPerPageTemplate="5,10,15,25,50,100" >                  

                                    <f:facet name="header" >          
                                        <table border="0" >
                                            <tr style="border-style: hidden;">
                                                <td style="border-style: hidden;" align="left" width="20px" ><p:ajaxStatus style="width:16px;height:16px;" id="ajaxStatusPanel" > <f:facet name="start"><h:graphicImage value="/resources/etsmtl/img/ajaxLoader1.gif" alt="Patientez Pendant le chargement....." /> </f:facet> <f:facet name="complete"> <h:outputText value="" /> </f:facet> </p:ajaxStatus></td>
                                                <td align="right"><h:outputText value=" Recherche Globale " /><p:inputText id="globalFilter" onkeyup="LaTable.filter()" size="23" /> <p:watermark for="globalFilter" value="Mots clés..." /></td>
                                            </tr>
                                        </table>
                                    </f:facet>

                                    <!--<composite:insertChildren id="colonneTableCrud" />-->
                                    <p:column sortBy="#{pan.nomSpectacle}" headerText="Show" >  
                                        <h:outputText value="#{pan.nomSpectacle}" />  
                                    </p:column>  

                                    <p:column sortBy="#{pan.dateRepresentation}" headerText="Date">  
                                        <h:outputText value="#{pan.dateRepresentation}" />  
                                    </p:column>  

                                    <p:column sortBy="#{pan.quantity}" headerText="Number">  
                                        <h:outputText value="#{pan.quantity}" />  
                                    </p:column>  

                                    <p:column sortBy="#{pan.prix}" headerText="Total price">  
                                        <h:outputText value="#{pan.prix}" />  
                                    </p:column>

                                    <f:facet name="footer"></f:facet>            

                                </p:dataTable>
                            </div>

                            <etsmtl:dialogDetails id="mydialog" >

                            </etsmtl:dialogDetails>


                            <p:blockUI block="dataPaiment" trigger="dataPaiment">  
                                LOADING<br />  
                                <p:graphicImage value="/resources/etsmtl/img/ajaxLoader5.gif"/>  
                            </p:blockUI>             
                        </p:panel>



                    </p:panel>  
                </p:tab>  

                <p:tab id="client" title="Client">  
                    <p:panel header="Client Details">  

                        <h:panelGrid columns="3" >
                            <etsmtl:inputTextLabel _id="nom" label="First Name" valeur="#{processPaiementCtrl.client.nom}" required="true" marginInputLabel="16" />
                            <etsmtl:inputTextLabel _id="prenom" label="Last Name" valeur="#{processPaiementCtrl.client.prenom}" required="true" />
                            <etsmtl:inputTextLabel _id="mail" label="E-mail" valeur="#{processPaiementCtrl.client.mail}" required="true" marginInputLabel="26" />

                            <etsmtl:inputTextLabel _id="rue" label="Street Address" valeur="#{processPaiementCtrl.client.adresse.rue}" required="false" />
                            <etsmtl:inputTextLabel _id="ville" label="City" valeur="#{processPaiementCtrl.client.adresse.region}" required="false" marginInputLabel="48" />
                            <etsmtl:inputTextLabel _id="codepost" label="Postal Code" valeur="#{processPaiementCtrl.client.adresse.codePostal}" required="false" />

                            <etsmtl:inputMaskLabel _id="phone" label="Phone" mask="999-999-9999" valeur="#{processPaiementCtrl.client.phone}" required="false"  marginInputLabel="50"  />
                            <etsmtl:inputTextLabel _id="pays" label="Country" valeur="#{processPaiementCtrl.client.adresse.ville}" required="false" marginInputLabel="27" />
                        </h:panelGrid>

                    </p:panel>  
                </p:tab>  

                <p:tab id="creditCard" title="Credit Card">  
                    <p:panel header="Credit Card Information">

                        <h:panelGrid columns="2" columnClasses="label, value">
                            <etsmtl:inputTextLabel _id="catecredi" label="Credit Card Number" valeur="#{processPaiementCtrl.carteCredit.numCarteCredit}" required="true" requiredMessage="Champ obligatoire" marginInputLabel="8" />
                            <etsmtl:calendarLabel _id="dateexpiration" label="Expiration Date" valeur="#{processPaiementCtrl.carteCredit.dateTransaction}" required="true" requiredMessage="Champ obligatoire" />
                            <etsmtl:inputTextLabel _id="codesecrt" label="Security Code (CVV)" valeur="#{processPaiementCtrl.carteCredit.numSecurite}" required="true" requiredMessage="Champ obligatoire" />                            
                        </h:panelGrid>  
                    </p:panel>  
                </p:tab>  

                <p:tab id="confirm" title="Confirmation">  
                    <p:panel header="Confirmation">  

                        <h:panelGrid id="confirmation" columns="1">
                            <etsmtl:outputLabel _id="infoNom" label="Last Name" valeur="#{processPaiementCtrl.client.nom}" />
                            <etsmtl:outputLabel _id="ifoIConfVente" label="Bill ID" valeur="00#{(Math.random() * 50 + 1960)}" />    
                        </h:panelGrid> <br/> 

                        <p:commandButton id="btnPayement" value="Paiement" disabled="#{cacheSessionPresentationCtrl.disablePaiement}" oncomplete="documentDialog.show()" icon="ui-icon-check" />
                        <p:commandButton value="Print" type="button" icon="ui-icon-print">  
                            <p:printer target="confirm" />  
                        </p:commandButton>

                        <p:dialog id="dialogPaimentOk" widgetVar="documentDialog" header="Détails de l’enregistrement" showEffect="clip" hideEffect="fold" modal="false">

                            Deuxième confirmation de paiement
                            
                            <br/><p:separator />
                            <div align="center" >
                                <h:panelGrid columns="3" border="0">
                                    <p:commandButton value="Validation Paiement" global="false" oncomplete="documentDialog.hide()" actionListener="#{processPaiementCtrl.save}" update=":processusPaiment:btnPayement" icon="ui-icon-close" />
                                    <p:commandButton value="Annuler" global="false" oncomplete="documentDialog.hide()" icon="ui-icon-close" />
                                </h:panelGrid>
                            </div>                            
                        </p:dialog>

                    </p:panel>  
                </p:tab>  

            </p:wizard>  

        </h:form>          

    </ui:define>


</ui:composition>
